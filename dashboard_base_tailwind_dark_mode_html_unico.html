<!doctype html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard Base ‚Ä¢ Tailwind + Dark Mode</title>
  
  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config (opcional): habilita clases arbitrarias sin tema extra
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Inter var", "Inter", "system-ui", "-apple-system", "Segoe UI", "Roboto", "Ubuntu", "Cantarell", "Noto Sans", "Helvetica Neue", "Arial", "\"Apple Color Emoji\"", "\"Segoe UI Emoji\"", "\"Segoe UI Symbol\""]
          },
          boxShadow: {
            soft: "0 1px 2px rgba(0,0,0,.04), 0 2px 12px rgba(0,0,0,.06)"
          }
        }
      }
    }
  </script>

  <!-- Variables de color base y modo oscuro (solo variables; todo el estilo usa Tailwind) -->
  <style>
    :root {
      /* Paleta base (modo claro) en formato OKLCH para mejor contraste */
      --c-bg: oklch(0.98 0.005 255);
      --c-surface: oklch(0.97 0.005 255);
      --c-elev: oklch(0.95 0.007 255);
      --c-text: oklch(0.22 0.02 255);
      --c-muted: oklch(0.47 0.02 255);
      --c-border: oklch(0.88 0.01 255);
      --c-primary: oklch(0.62 0.13 260);
      --c-primary-ink: oklch(0.18 0.03 260);
      --c-accent: oklch(0.7 0.12 170);
      --c-danger: oklch(0.65 0.18 25);
      --radius: 14px;
    }
    html[data-theme="dark"] {
      --c-bg: oklch(0.17 0.02 255);
      --c-surface: oklch(0.21 0.02 255);
      --c-elev: oklch(0.25 0.02 255);
      --c-text: oklch(0.93 0.02 255);
      --c-muted: oklch(0.74 0.02 255);
      --c-border: oklch(0.35 0.02 255);
      --c-primary: oklch(0.72 0.14 260);
      --c-primary-ink: oklch(0.12 0.02 260);
      --c-accent: oklch(0.75 0.13 170);
      --c-danger: oklch(0.68 0.21 25);
    }
    /* Scrollbar sutil */
    ::-webkit-scrollbar{width:10px;height:10px}
    ::-webkit-scrollbar-thumb{background:var(--c-border);border-radius:999px}
    ::-webkit-scrollbar-track{background:transparent}
  </style>
</head>
<body class="min-h-screen bg-[var(--c-bg)] text-[var(--c-text)] font-sans">
  <!--
    -----------------------------------------------------------
    LAYOUT PRINCIPAL
    - Aside (Barra lateral)
    - Header (Barra superior)
    - Main (Contenido del dashboard)
    - Footer (Pie de p√°gina)
    -----------------------------------------------------------
  -->

  <!-- Backdrop m√≥vil para el sidebar -->
  <div id="dash-backdrop" class="lg:hidden fixed inset-0 bg-black/40 backdrop-blur-sm hidden"></div>

  <div class="grid grid-cols-1 lg:grid-cols-[280px_1fr]">

    <!-- ========================= ASIDE / SIDEBAR ========================= -->
    <aside id="dash-sidebar" class="fixed lg:static inset-y-0 left-0 z-40 w-[80%] max-w-[320px] lg:w-auto translate-x-[-100%] lg:translate-x-0 transition-transform duration-300 ease-out will-change-transform bg-[var(--c-surface)] border-r border-[var(--c-border)]">
      <div class="h-full flex flex-col">
        <!-- Branding -->
        <div class="flex items-center gap-3 px-5 py-4 border-b border-[var(--c-border)]">
          <div class="size-9 rounded-xl grid place-items-center bg-[var(--c-primary)] text-white font-bold shadow-soft">D</div>
          <div>
            <h1 class="text-base font-semibold leading-tight">Dashboard Base</h1>
            <p class="text-xs text-[var(--c-muted)] leading-tight">Layout modular</p>
          </div>
        </div>

        <!-- Buscador en el sidebar -->
        <div class="px-4 py-3 border-b border-[var(--c-border)]">
          <label for="dash-sidebar-search" class="sr-only">Buscar</label>
          <div class="flex items-center gap-2 rounded-2xl bg-[var(--c-elev)] px-3 py-2 ring-1 ring-[var(--c-border)] focus-within:ring-[var(--c-primary)]">
            <svg class="size-5 opacity-70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
            <input id="dash-sidebar-search" type="search" placeholder="Buscar‚Ä¶" class="bg-transparent outline-none w-full text-sm placeholder:text-[var(--c-muted)]" />
          </div>
        </div>

        <!-- Men√∫ (Acorde√≥n modular) -->
        <nav id="dash-accordion" class="flex-1 overflow-y-auto p-2 space-y-2">
          <!-- Grupo 1 -->
          <section class="rounded-2xl overflow-hidden ring-1 ring-[var(--c-border)]">
            <button id="dash-acc-btn-1" class="w-full flex items-center justify-between gap-3 px-4 py-3 bg-[var(--c-elev)] hover:bg-[var(--c-elev)]/80 transition" aria-controls="dash-acc-panel-1" aria-expanded="true">
              <span class="flex items-center gap-3">
                <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12h18"></path><path d="M3 6h18"></path><path d="M3 18h18"></path></svg>
                <span class="text-sm font-medium">General</span>
              </span>
              <svg class="size-4 rotate-0 transition-transform" id="dash-acc-icon-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
            <div id="dash-acc-panel-1" class="overflow-hidden transition-[max-height] duration-300 ease-in-out" style="max-height: 0px;">
              
              <div class="p-2 bg-[var(--c-surface)] min-h-0">
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üè†</span>Inicio</a>
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üìÑ</span>Reportes</a>
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üì¶</span>Productos</a>
              </div>
            </div>
          </section>

          <!-- Grupo 2 -->
          <section class="rounded-2xl overflow-hidden ring-1 ring-[var(--c-border)]">
            <button id="dash-acc-btn-2" class="w-full flex items-center justify-between gap-3 px-4 py-3 bg-[var(--c-elev)] hover:bg-[var(--c-elev)]/80 transition" aria-controls="dash-acc-panel-2" aria-expanded="false">
              <span class="flex items-center gap-3">
                <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M7 8h10"/><path d="M7 12h10"/><path d="M7 16h10"/></svg>
                <span class="text-sm font-medium">Gesti√≥n</span>
              </span>
              <svg class="size-4 -rotate-90 transition-transform" id="dash-acc-icon-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
            <div id="dash-acc-panel-2" class="overflow-hidden transition-[max-height] duration-300 ease-in-out" style="max-height: 0px;">
              
              <div class="p-2 bg-[var(--c-surface)] min-h-0">
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üë•</span>Usuarios</a>
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üõ†</span>Roles & Permisos</a>
              </div>
            </div>
          </section>

          <!-- Grupo 3 -->
          <section class="rounded-2xl overflow-hidden ring-1 ring-[var(--c-border)]">
            <button id="dash-acc-btn-3" class="w-full flex items-center justify-between gap-3 px-4 py-3 bg-[var(--c-elev)] hover:bg-[var(--c-elev)]/80 transition" aria-controls="dash-acc-panel-3" aria-expanded="false">
              <span class="flex items-center gap-3">
                <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20"/><path d="M2 12h20"/></svg>
                <span class="text-sm font-medium">Ajustes</span>
              </span>
              <svg class="size-4 -rotate-90 transition-transform" id="dash-acc-icon-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
            <div id="dash-acc-panel-3" class="overflow-hidden transition-[max-height] duration-300 ease-in-out" style="max-height: 0px;">
              
              <div class="p-2 bg-[var(--c-surface)] min-h-0">
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üé®</span>Tema & Marca</a>
                <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-[var(--c-elev)] transition text-sm"><span class="size-6 grid place-items-center rounded-lg ring-1 ring-[var(--c-border)]">üîî</span>Notificaciones</a>
              </div>
            </div>
          </section>
        </nav>

        <!-- Footer del sidebar -->
        <div class="mt-auto px-4 py-3 border-t border-[var(--c-border)] flex items-center justify-between">
          <button id="dash-theme-toggle" class="inline-flex items-center gap-2 text-sm px-3 py-2 rounded-xl ring-1 ring-[var(--c-border)] hover:ring-[var(--c-primary)]">
            <span id="dash-theme-icon">üåû</span>
            <span id="dash-theme-label">Modo oscuro</span>
          </button>
          <a href="#" class="text-xs text-[var(--c-muted)] hover:underline">v1.0</a>
        </div>
      </div>
    </aside>

    <!-- ========================= CONTENIDO (Header + Main + Footer) ========================= -->
    <div class="lg:col-start-2">
      <!-- ===== HEADER / TOPBAR ===== -->
      <header id="dash-header" class="sticky top-0 z-30 bg-[var(--c-bg)]/80 backdrop-blur border-b border-[var(--c-border)]">
        <div class="flex items-center justify-between gap-3 px-4 sm:px-6 py-3">
          <!-- Bot√≥n hamburguesa (m√≥vil) -->
          <button id="dash-menu-btn" class="lg:hidden inline-flex items-center gap-2 px-3 py-2 rounded-xl ring-1 ring-[var(--c-border)]">
            <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M3 12h18"/><path d="M3 18h18"/></svg>
            <span class="text-sm">Men√∫</span>
          </button>

          <!-- Migas / T√≠tulo -->
          <div class="hidden sm:flex items-center gap-2 text-sm">
            <a href="#" class="text-[var(--c-muted)] hover:text-[var(--c-text)]">Inicio</a>
            <span class="opacity-50">/</span>
            <span class="font-medium">Dashboard</span>
          </div>

          <!-- Acciones derechas -->
          <div class="flex items-center gap-2 sm:gap-3 ml-auto">
            <div class="hidden md:flex items-center gap-2 rounded-2xl bg-[var(--c-elev)] px-3 py-2 ring-1 ring-[var(--c-border)] focus-within:ring-[var(--c-primary)]">
              <svg class="size-5 opacity-70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
              <input id="dash-top-search" type="search" placeholder="Buscar en todo‚Ä¶" class="bg-transparent outline-none w-64 text-sm placeholder:text-[var(--c-muted)]" />
            </div>
            <button id="dash-action-new" class="hidden sm:inline-flex items-center gap-2 text-sm px-3 py-2 rounded-xl bg-[var(--c-primary)] text-white hover:opacity-95 shadow-soft">
              <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
              Nuevo
            </button>
            <button id="dash-bell" class="inline-flex size-10 items-center justify-center rounded-xl ring-1 ring-[var(--c-border)] hover:ring-[var(--c-primary)]">
              <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.7 1.7 0 0 0 3.4 0"/></svg>
            </button>
            <button id="dash-avatar" class="inline-flex items-center gap-3 px-2 py-1 rounded-xl ring-1 ring-[var(--c-border)] hover:ring-[var(--c-primary)]">
              <img alt="avatar" src="https://i.pravatar.cc/100?img=5" class="size-8 rounded-lg"/>
              <span class="hidden sm:block text-sm">Alex</span>
            </button>
          </div>
        </div>
      </header>

      <!-- ===== MAIN ===== -->
      <main id="dash-main" class="px-4 sm:px-6 py-6 space-y-6">
        <!-- ===================== VISTA: Embudo de Ventas ===================== -->
        <header class="flex items-center justify-between">
          <div class="flex items-center gap-2 text-sm">
            <a href="#" class="text-[var(--c-muted)] hover:text-[var(--c-text)]">CRM</a>
            <span class="opacity-50">/</span>
            <span class="font-medium">Embudo de ventas</span>
          </div>
          <div class="flex items-center gap-2">
            <button id="dash-funnel-add" class="inline-flex items-center gap-2 text-sm px-3 py-2 rounded-xl bg-[var(--c-primary)] text-white shadow-soft">
              <svg class="size-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
              Nuevo lead
            </button>
          </div>
        </header>

        <!-- Board scrollable en pantallas peque√±as; grid en xl -->
        <section id="dash-funnel-board" class="relative overflow-x-auto pb-2">
          <div class="min-w-[1200px] grid grid-cols-7 gap-4 xl:min-w-0">
            <!-- Stages -->
            <template id="dash-funnel-card-tpl">
              <article class="dash-card select-none rounded-xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] p-3 shadow-soft cursor-move" draggable="true" role="article" aria-grabbed="false">
                <header class="flex items-center justify-between gap-2">
                  <h4 class="text-sm font-semibold">Nuevo lead</h4>
                  <span class="text-[10px] px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">S/ 0</span>
                </header>
                <p class="mt-1 text-xs text-[var(--c-muted)]">Sin asignar</p>
              </article>
            </template>

            <!-- Prospecci√≥n -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="prospeccion">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Prospecci√≥n</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-prospeccion" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Contacto inicial -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="contacto">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Contacto inicial</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-contacto" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Calificaci√≥n -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="calificacion">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Calificaci√≥n</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-calificacion" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Propuesta -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="propuesta">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Propuesta</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-propuesta" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Negociaci√≥n -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="negociacion">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Negociaci√≥n</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-negociacion" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Cierre (Ganado) -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="ganado">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Cierre ganado</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-ganado" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>

            <!-- Cierre (Perdido) -->
            <section class="dash-stage rounded-2xl ring-1 ring-[var(--c-border)] bg-[var(--c-surface)] flex flex-col" data-stage="perdido">
              <header class="flex items-center justify-between px-4 py-3 border-b border-[var(--c-border)]">
                <h3 class="text-sm font-semibold">Cierre perdido</h3>
                <span class="dash-count text-xs px-2 py-0.5 rounded-lg bg-[var(--c-elev)] ring-1 ring-[var(--c-border)]">0</span>
              </header>
              <div id="dash-stage-perdido" class="dash-dropzone flex-1 overflow-y-auto p-3 space-y-3" role="list"></div>
              <div class="p-3 border-t border-[var(--c-border)]"><button class="dash-add text-xs px-2 py-1 rounded-lg ring-1 ring-[var(--c-border)]">Agregar</button></div>
            </section>
          </div>
        </section>

        <!-- Script de la vista (solo para el embudo; f√°cil de extraer luego) -->
        <script id="dash-funnel-script">
          (function(){
            const board = document.getElementById('dash-funnel-board');
            const tpl = document.getElementById('dash-funnel-card-tpl');
            const addGlobal = document.getElementById('dash-funnel-add');
            const uid = () => 'dash-card-' + Math.random().toString(36).slice(2, 9);

            // Crea una tarjeta b√°sica
            function createCard({title='Nuevo lead', owner='Sin asignar', amount='S/ 0'}={}){
              const node = tpl.content.firstElementChild.cloneNode(true);
              node.id = uid();
              node.querySelector('h4').textContent = title;
              node.querySelector('span').textContent = amount;
              node.querySelector('p').textContent = owner;
              return node;
            }

            // Inicial: a√±ade ejemplos a Prospecci√≥n
            const firstZone = document.getElementById('dash-stage-prospeccion');
            ['Acme S.A.', 'Globex', 'Soylent Corp.', 'Initech'].forEach((n,i)=>{
              firstZone.appendChild(createCard({title: n, owner: 'Sin asignar', amount: 'S/ ' + (i*500+500)}));
            });
            updateCounts();

            // Event delegation para drag & drop
            let dragId = null;
            board.addEventListener('dragstart', (e)=>{
              const card = e.target.closest('.dash-card');
              if(!card) return;
              dragId = card.id;
              e.dataTransfer.setData('text/plain', dragId);
              e.dataTransfer.effectAllowed = 'move';
              card.classList.add('opacity-70');
              card.setAttribute('aria-grabbed','true');
            });
            board.addEventListener('dragend', (e)=>{
              const card = e.target.closest('.dash-card');
              if(card){
                card.classList.remove('opacity-70');
                card.setAttribute('aria-grabbed','false');
              }
              dragId = null;
              clearHighlights();
              updateCounts();
            });

            board.addEventListener('dragover', (e)=>{
              const zone = e.target.closest('.dash-dropzone');
              if(!zone) return;
              e.preventDefault();
              e.dataTransfer.dropEffect = 'move';
              zone.classList.add('ring-2','ring-[var(--c-primary)]/60');
            });

            board.addEventListener('dragleave', (e)=>{
              const zone = e.target.closest('.dash-dropzone');
              if(!zone) return;
              zone.classList.remove('ring-2','ring-[var(--c-primary)]/60');
            });

            board.addEventListener('drop', (e)=>{
              const zone = e.target.closest('.dash-dropzone');
              if(!zone) return;
              e.preventDefault();
              const id = e.dataTransfer.getData('text/plain') || dragId;
              const card = document.getElementById(id);
              if(card){ zone.appendChild(card); }
              zone.classList.remove('ring-2','ring-[var(--c-primary)]/60');
              updateCounts();
            });

            function clearHighlights(){
              document.querySelectorAll('.dash-dropzone').forEach(z=>z.classList.remove('ring-2','ring-[var(--c-primary)]/60'));
            }

            function updateCounts(){
              document.querySelectorAll('.dash-stage').forEach(stage=>{
                const count = stage.querySelectorAll('.dash-card').length;
                const badge = stage.querySelector('.dash-count');
                if(badge) badge.textContent = count;
              });
            }

            // Bot√≥n global y botones por columna para crear tarjetas
            addGlobal?.addEventListener('click', ()=>{
              firstZone.appendChild(createCard());
              updateCounts();
            });
            board.querySelectorAll('.dash-stage .dash-add').forEach(btn=>{
              btn.addEventListener('click', ()=>{
                const zone = btn.closest('.dash-stage').querySelector('.dash-dropzone');
                zone.appendChild(createCard());
                updateCounts();
              });
            });
          })();
        </script>
      </main>

      <!-- ===== FOOTER ===== -->
      <footer id="dash-footer" class="px-4 sm:px-6 py-6 border-t border-[var(--c-border)] text-sm text-[var(--c-muted)]">
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 justify-between">
          <p>¬© <span id="dash-year"></span> Tu Empresa. Todos los derechos reservados.</p>
          <div class="flex items-center gap-3">
            <a href="#" class="hover:underline">Privacidad</a>
            <a href="#" class="hover:underline">T√©rminos</a>
            <a href="#" class="hover:underline">Contacto</a>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <!-- ========================= SCRIPTS (IDs √∫nicos prefijados con dash-) ========================= -->
  <script>
    (function(){
      // --- Persistencia de tema ---
      const THEME_KEY = 'dash-theme';
      const root = document.documentElement;
      const themeBtn = document.getElementById('dash-theme-toggle');
      const themeIcon = document.getElementById('dash-theme-icon');
      const themeLabel = document.getElementById('dash-theme-label');

      const applyTheme = (mode) => {
        root.setAttribute('data-theme', mode);
        localStorage.setItem(THEME_KEY, mode);
        const dark = mode === 'dark';
        themeIcon.textContent = dark ? 'üåô' : 'üåû';
        themeLabel.textContent = dark ? 'Modo claro' : 'Modo oscuro';
      };

      const saved = localStorage.getItem(THEME_KEY);
      if(saved === 'dark' || (!saved && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)){
        applyTheme('dark');
      } else {
        applyTheme(saved || 'light');
      }

      themeBtn?.addEventListener('click', () => {
        applyTheme(root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
      });

      // --- A√±o del footer ---
      document.getElementById('dash-year').textContent = new Date().getFullYear();

      // --- Sidebar responsive ---
      const sidebar = document.getElementById('dash-sidebar');
      const menuBtn = document.getElementById('dash-menu-btn');
      const backdrop = document.getElementById('dash-backdrop');
      const openSidebar = () => {
        sidebar.style.transform = 'translateX(0)';
        backdrop.classList.remove('hidden');
      };
      const closeSidebar = () => {
        sidebar.style.transform = '';
        backdrop.classList.add('hidden');
      };
      menuBtn?.addEventListener('click', openSidebar);
      backdrop?.addEventListener('click', closeSidebar);
      window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeSidebar(); });

      // --- Acorde√≥n modular (mejorado: max-height + modo "uno abierto") ---
      const ACCORDION_SINGLE_OPEN = false; // cambia a true si quieres solo un m√≥dulo abierto a la vez
      const accordionItems = [
        { btn: 'dash-acc-btn-1', panel: 'dash-acc-panel-1', icon: 'dash-acc-icon-1', defaultOpen: true },
        { btn: 'dash-acc-btn-2', panel: 'dash-acc-panel-2', icon: 'dash-acc-icon-2', defaultOpen: false },
        { btn: 'dash-acc-btn-3', panel: 'dash-acc-panel-3', icon: 'dash-acc-icon-3', defaultOpen: false },
      ];

      const openPanel = (panelEl, btnEl, iconEl) => {
        panelEl.style.maxHeight = panelEl.scrollHeight + 'px';
        btnEl.setAttribute('aria-expanded', 'true');
        if(iconEl) iconEl.style.transform = 'rotate(0deg)';
      };
      const closePanel = (panelEl, btnEl, iconEl) => {
        panelEl.style.maxHeight = '0px';
        btnEl.setAttribute('aria-expanded', 'false');
        if(iconEl) iconEl.style.transform = 'rotate(-90deg)';
      };

      const instances = accordionItems.map(({btn, panel, icon, defaultOpen}) => {
        const btnEl = document.getElementById(btn);
        const panelEl = document.getElementById(panel);
        const iconEl = icon ? document.getElementById(icon) : null;
        if(!btnEl || !panelEl) return null;

        // Estado inicial
        if(defaultOpen) openPanel(panelEl, btnEl, iconEl); else closePanel(panelEl, btnEl, iconEl);

        btnEl.addEventListener('click', () => {
          const isOpen = btnEl.getAttribute('aria-expanded') === 'true';
          if(isOpen){
            // permite cerrar tambi√©n el primero
            closePanel(panelEl, btnEl, iconEl);
          } else {
            if(ACCORDION_SINGLE_OPEN){
              instances.forEach(inst => {
                if(!inst) return;
                if(inst.panelEl !== panelEl) closePanel(inst.panelEl, inst.btnEl, inst.iconEl);
              });
            }
            openPanel(panelEl, btnEl, iconEl);
          }
        });

        return { btnEl, panelEl, iconEl };
      }).filter(Boolean);

      // --- Acciones simuladas ---
      document.getElementById('dash-action-new')?.addEventListener('click', ()=>{
        alert('Acci√≥n: Crear nuevo registro');
      });
    })();
  </script>
</body>
</html>
